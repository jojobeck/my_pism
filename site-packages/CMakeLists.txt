# Install some Python-based pieces of PISM
if (Pism_BUILD_PYTHON_BINDINGS)
  install (PROGRAMS
    ${Pism_SOURCE_DIR}/examples/python/ssa_forward.py
    ${Pism_SOURCE_DIR}/examples/python/sia_forward.py
    ${Pism_SOURCE_DIR}/examples/inverse/make_synth_ssa.py
    ${Pism_SOURCE_DIR}/examples/inverse/pismi.py
    ${Pism_SOURCE_DIR}/examples/inverse/verify_ssa_inv.py
    DESTINATION ${Pism_BIN_DIR} )

  install(DIRECTORY
    ${Pism_SOURCE_DIR}/site-packages/PISM
    DESTINATION ${PISM_INSTALL_PYTHON_MODULE_DIR}
    USE_SOURCE_PERMISSIONS
    COMPONENT RuntimeLibraries
    )

  install(DIRECTORY
    ${Pism_SOURCE_DIR}/site-packages/siple
    DESTINATION ${PISM_INSTALL_PYTHON_MODULE_DIR}
    USE_SOURCE_PERMISSIONS
    COMPONENT RuntimeLibraries
    )
endif()

set(PISM_PYTHON_LIBRARY_FILES
  PISM/__init__.py
  PISM/invert/__init__.py
  PISM/invert/listener.py
  PISM/invert/sipletools.py
  PISM/invert/ssa.py
  PISM/invert/ssa_gn.py
  PISM/invert/ssa_siple.py
  PISM/invert/ssa_tao.py
  PISM/logging.py
  PISM/model.py
  PISM/sia.py
  PISM/ssa.py
  PISM/util.py
  PISM/vec.py
  )


add_custom_target (install_site_packages_in_the_build_directory ALL
  COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_CURRENT_SOURCE_DIR}/PISM ${CMAKE_CURRENT_BINARY_DIR}/PISM
  COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_CURRENT_SOURCE_DIR}/siple ${CMAKE_CURRENT_BINARY_DIR}/siple
  VERBATIM
  DEPENDS ${PISM_PYTHON_LIBRARY_FILES}
  )
